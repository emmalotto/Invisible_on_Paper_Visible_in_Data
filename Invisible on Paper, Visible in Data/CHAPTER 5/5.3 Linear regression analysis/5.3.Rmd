---
title: '5.3'
author: "Lotto Emma"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Predictors of Fertility Preferences: Linear Regression Analyses 

This R script contains all commands and code necessary to reproduce the analyses reported in Chapter 5.3, “Predictors of Fertility Preferences: Linear Regression Analyses”. This file contains the single models and the related AIC and subsequently the step by step models with the related AIC.

```{r}
rm(list=ls())
source("../../preprocessing.R")
library(tidyverse)
```

linear model (lm) outcome: fertility intentions

SINGLE MODELS:

```{r}
summary(lm(desired_children ~ Q1, data = model_data))
summary(lm(desired_children ~ B1, data = model_data))
summary(lm(desired_children ~ marital_group, data = model_data))
summary(lm(desired_children ~ educ_group, data = model_data))
summary(lm(desired_children ~ undocumented_def, data = model_data))
summary(lm(desired_children ~ nubian, data = model_data))

```

AIC:

```{r}
AIC(lm(desired_children ~ Q1, data = model_data))
AIC(lm(desired_children ~ B1, data = model_data))
AIC(lm(desired_children ~ marital_group, data = model_data))
AIC(lm(desired_children ~ educ_group, data = model_data))
AIC(lm(desired_children ~ undocumented_def, data = model_data))
AIC(lm(desired_children ~ nubian, data = model_data))

```

STEP BY STEP MODELS:

```{r}
# Modello 1: only age 
mod1 <- lm(desired_children ~ Q1, data = model_data)

# Modello 2: + gender
mod2 <- lm(desired_children ~ Q1 + B1, data = model_data)

# Modello 3: + marital status
mod3 <- lm(desired_children ~ Q1 + B1 + marital_group, data = model_data)

# Modello 4: + education
mod4 <- lm(desired_children ~ Q1 + B1 + marital_group + educ_group, data = model_data)

# Modello 5: + documentation
mod5 <- lm(desired_children ~ Q1 + B1 + marital_group + educ_group + undocumented_def, data = model_data)

# Modello 6: + nubian
mod6 <- lm(desired_children ~ Q1 + B1 + marital_group + educ_group + undocumented_def + nubian, data = model_data)


library(modelsummary)

modelsummary(
  list("Model 1" = mod1,
       "Model 2" = mod2,
       "Model 3" = mod3,
       "Model 4" = mod4,
       "Model 5" = mod5,
       "Model 6" = mod6),
  fmt = 2,
  statistic = "p.value",
  stars = TRUE,
  output = "markdown" 
)


```

AIC

```{r}
AIC(mod1)
AIC(mod2)
AIC(mod3)
AIC(mod4)
AIC(mod5)
AIC(mod6)
```
